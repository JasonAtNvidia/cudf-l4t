// Copyright (c) 2022, NVIDIA CORPORATION.

#include <cudf/strings/udf/dstring.cuh>

#include "../tests/utilities.cuh"

__global__ void udf_kernel( cudf::string_view* d_in_strs, int size, cudf::strings::udf::dstring* d_out_strs, int count )
{
    int tid = (blockDim.x * blockIdx.x) + threadIdx.x;
    if( tid > 0 ) return;

    using dstring = cudf::strings::udf::dstring;

    auto const test_data = cudf::string_view{"0123456789", 10};

    dstring d_test{test_data};

    auto d_str = d_test.substr(0, 5);
    verify(d_str, cudf::string_view{"01234", 5}, "substr(0,5)");

    d_str = d_test.substr(5);
    verify(d_str, cudf::string_view{"56789", 5}, "substr(5)");
    d_str = d_test.substr(5, 45);
    verify(d_str, cudf::string_view{"56789", 5}, "substr(5, 45)");

    d_str = d_test.substr(0);
    verify(d_str, test_data, "substr(0)");
    d_str = d_test.substr(-1);
    verify(d_str, cudf::string_view("",0), "substr(-1)");

    d_str = d_test.substr(3,0);
    verify(d_str, cudf::string_view("",0), "substr(3,0)");

    d_out_strs[tid] = d_in_strs[tid];
}
